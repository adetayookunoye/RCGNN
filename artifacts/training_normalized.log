/home/adetayo/anaconda3/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)

==========================================================================================
üöÄ FULL RC-GNN PRODUCTION TRAINING
==========================================================================================
Started at: 2025-10-26 13:24:43
==========================================================================================

üìã Loading configuration files...
‚úÖ Configuration loaded
   - Training epochs: 100
   - Batch size: 8
   - LR range: 3e-06 ‚Üí 5e-05
   - Device: cpu

üìä Loading UCI Air Quality dataset...
   Path: data/interim/uci_air

üîß Normalizing data...
   ‚úÖ Data normalized (mean‚âà0, std‚âà1)
   - Train: mean=-0.000, std=1.000
   - Val: mean=-0.319, std=1.358

‚úÖ Dataset loaded:
   - Features: 13
   - Train samples: 6613
   - Val samples: 1417

üèóÔ∏è  Initializing RC-GNN model...
‚úÖ Model initialized on cpu
   - Latent dim: 16
   - Hidden dim: 32
   - Sparsify method: topk
‚úÖ Optimizer initialized:
   - Initial LR: 3e-06 (warmup start)
   - Max LR: 5e-05 (reached after 5 epochs)
   - Weight decay: 1e-05

üìã Loading ground truth adjacency...
‚úÖ Ground truth loaded: 13 edges in DAG

==========================================================================================
[TRAINING] Starting full training loop
==========================================================================================
Epoch   1/100 | Loss:  82.2241 | Clip:100.0% LR=1.24e-05

Epoch   2/100 | Loss:  71.6728 (Recon:100.0% Sparse:0.0% Disen:0.0% Acyc:0.0%)
  Val: F1=0.133 SHD=59.0 | Edges: tuned=77 @0.5=0 topk=15
  Logits: mean=-0.0042 std=0.0938 %>0=49.4% | Clip:100.0% LR=2.18e-05 ‚≠ê BEST
Epoch   3/100 | Loss:  45.1125 | Clip:100.0% LR=3.12e-05
Epoch   4/100 | Loss:  21.3043 | Val F1=0.132 SHD=60.0 | Edges: tuned=78 @0.5=0 topk=15 | Clip:100.0% LR=4.06e-05 | Patience:1/15
Epoch   5/100 | Loss:   8.5844 | Clip:100.0% LR=5.00e-05
Epoch   6/100 | Loss:   5.0507 | Val F1=0.133 SHD=59.0 | Edges: tuned=77 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:2/15
Epoch   7/100 | Loss:   3.8619 | Clip:100.0% LR=5.00e-05

Epoch   8/100 | Loss:   3.0889 (Recon:100.0% Sparse:0.0% Disen:0.0% Acyc:0.0%)
  Val: F1=0.136 SHD=58.0 | Edges: tuned=75 @0.5=0 topk=15
  Logits: mean=-0.0007 std=0.0170 %>0=48.1% | Clip:100.0% LR=5.00e-05 ‚≠ê BEST
Epoch   9/100 | Loss:   2.4793 | Clip:100.0% LR=5.00e-05
Epoch  10/100 | Loss:   1.9323 | Val F1=0.136 SHD=58.0 | Edges: tuned=75 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:1/15
Epoch  11/100 | Loss:   1.4680 | Clip:100.0% LR=5.00e-05

Epoch  12/100 | Loss:   1.0800 (Recon:100.0% Sparse:0.0% Disen:0.0% Acyc:0.0%)
  Val: F1=0.100 SHD=18.0 | Edges: tuned=7 @0.5=0 topk=15
  Logits: mean=-0.0002 std=0.0015 %>0=4.5% | Clip:100.0% LR=5.00e-05 ‚≠ê BEST
Epoch  13/100 | Loss:   0.7935 | Clip:100.0% LR=5.00e-05

Epoch  14/100 | Loss:   0.6027 (Recon:100.0% Sparse:0.0% Disen:0.0% Acyc:0.0%)
  Val: F1=0.000 SHD=14.0 | Edges: tuned=1 @0.5=0 topk=15
  Logits: mean=-0.0000 std=0.0001 %>0=0.6% | Clip:100.0% LR=5.00e-05 ‚≠ê BEST
Epoch  15/100 | Loss:   0.4745 | Clip:100.0% LR=5.00e-05

Epoch  16/100 | Loss:   0.3792 (Recon:100.0% Sparse:0.0% Disen:0.0% Acyc:0.0%)
  Val: F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15
  Logits: mean=-0.0000 std=0.0000 %>0=0.0% | Clip:100.0% LR=5.00e-05 ‚≠ê BEST
Epoch  17/100 | Loss:   0.3038 | Clip:100.0% LR=5.00e-05
Epoch  18/100 | Loss:   0.2469 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:1/15
Epoch  19/100 | Loss:   0.2056 | Clip:100.0% LR=5.00e-05
Epoch  20/100 | Loss:   0.1758 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:2/15
Epoch  21/100 | Loss:   0.1536 | Clip:100.0% LR=5.00e-05
Epoch  22/100 | Loss:   0.1366 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:3/15
Epoch  23/100 | Loss:   0.1233 | Clip:100.0% LR=5.00e-05
Epoch  24/100 | Loss:   0.1125 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:4/15
Epoch  25/100 | Loss:   0.1034 | Clip:100.0% LR=5.00e-05
Epoch  26/100 | Loss:   0.0959 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:5/15
Epoch  27/100 | Loss:   0.0891 | Clip:100.0% LR=5.00e-05
Epoch  28/100 | Loss:   0.0832 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:6/15
Epoch  29/100 | Loss:   0.0781 | Clip:100.0% LR=5.00e-05
Epoch  30/100 | Loss:   0.0735 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:7/15
Epoch  31/100 | Loss:   0.0693 | Clip:100.0% LR=5.00e-05
Epoch  32/100 | Loss:   0.0654 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:8/15
Epoch  33/100 | Loss:   0.0619 | Clip:100.0% LR=5.00e-05
Epoch  34/100 | Loss:   0.0587 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:9/15
Epoch  35/100 | Loss:   0.0556 | Clip:100.0% LR=5.00e-05
Epoch  36/100 | Loss:   0.0528 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:10/15
Epoch  37/100 | Loss:   0.0501 | Clip:100.0% LR=5.00e-05
Epoch  38/100 | Loss:   0.0477 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:11/15
Epoch  39/100 | Loss:   0.0454 | Clip:100.0% LR=5.00e-05
Epoch  40/100 | Loss:   0.0432 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:12/15
Epoch  41/100 | Loss:   0.0412 | Clip:100.0% LR=5.00e-05
Epoch  42/100 | Loss:   0.0393 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:13/15
Epoch  43/100 | Loss:   0.0375 | Clip:100.0% LR=5.00e-05
Epoch  44/100 | Loss:   0.0358 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:14/15
Epoch  45/100 | Loss:   0.0342 | Clip:100.0% LR=5.00e-05
Epoch  46/100 | Loss:   0.0327 | Val F1=0.000 SHD=13.0 | Edges: tuned=0 @0.5=0 topk=15 | Clip:100.0% LR=5.00e-05 | Patience:15/15

‚èπÔ∏è  Early stopping triggered after 46 epochs (no improvement for 15 evals)

==========================================================================================
‚úÖ TRAINING COMPLETE
==========================================================================================
Total training time: 5.61 minutes (336.7 seconds)
Total epochs: 46/100
Best validation SHD: 13.0
Avg epoch time: 7.32 seconds

üìä Training history saved to: artifacts/training_history_full.json
‚úÖ Metrics saved to: artifacts/training_metrics_full.json

üìÅ Generated artifacts:
   ‚úÖ Model checkpoint: artifacts/checkpoints/rcgnn_best.pt (0.0 MB)
   ‚úÖ Adjacency matrix: artifacts/adjacency/A_mean.npy (sparsity: 100.00%)

üìù Next steps:
   1. Run threshold optimization: make analyze
   2. Compare baselines: make baseline
   3. View full results: make results

‚úÖ Full training pipeline ready!
