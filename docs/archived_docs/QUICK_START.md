# ğŸ¯ Quick Command Reference

## âœ… You Now Have These Scripts

### **Main Scripts** (New or Updated)
1. **`scripts/train_and_visualize.py`** â­ NEW
   - Full training + automatic visualization
   - One-command solution
   
2. **`scripts/validate_and_visualize.py`** âœ… EXISTING
   - Standalone validation/visualization 
   - Reuse trained models

3. **`scripts/train_validate_visualize.py`** âœ… EXISTING
   - Alternative combined approach

### **Helper Scripts** âœ… EXISTING
- `scripts/path_helper.py` - Resolves imports
- `scripts/train_rcgnn.py` - Original training script
- `scripts/eval_rcgnn.py` - Evaluation script

---

## ğŸš€ Quick Start Commands

### **Recommended: Full Pipeline (New)**
```bash
cd /home/adetayo/Documents/CSCI\ Forms/Adetayo\ Research/Robust\ Causal\ Graph\ Neural\ Networks\ under\ Compound\ Sensor\ Corruptions/rcgnn

# Train + visualize automatically
python scripts/train_and_visualize.py configs/data_uci.yaml configs/model.yaml configs/train.yaml
```

**Output:**
- âœ… `artifacts/checkpoints/rcgnn_best.pt`
- âœ… `artifacts/adjacency/A_mean.npy`
- âœ… `artifacts/visualizations/01_adjacency_heatmap.png`
- âœ… `artifacts/visualizations/02_edge_distribution.png`
- âœ… `artifacts/visualizations/03_causal_graph.png`
- âœ… `artifacts/visualizations/validation_report.txt`

---

### **Alternative: Visualize Existing Model**
```bash
# After running train_and_visualize.py:
python scripts/validate_and_visualize.py

# Or with custom paths:
python scripts/validate_and_visualize.py \
  --adjacency artifacts/adjacency/A_mean.npy \
  --export artifacts/visualizations \
  --data-root data/interim/uci_air
```

---

### **Original Workflow (Still Works)**
```bash
# Just training (no visualization)
python scripts/train_rcgnn.py configs/data_uci.yaml configs/model.yaml configs/train.yaml

# Then visualize separately
python scripts/validate_and_visualize.py
```

---

## ğŸ“Š What Gets Generated

```
artifacts/
â”œâ”€â”€ checkpoints/
â”‚   â””â”€â”€ rcgnn_best.pt                    # Trained model (best validation)
â”œâ”€â”€ adjacency/
â”‚   â””â”€â”€ A_mean.npy                       # Learned causal structure (13Ã—13)
â””â”€â”€ visualizations/                      # Generated by train_and_visualize.py
    â”œâ”€â”€ 01_adjacency_heatmap.png         # Full adjacency matrix visualization
    â”œâ”€â”€ 02_edge_distribution.png         # Edge strength histogram
    â”œâ”€â”€ 03_causal_graph.png              # Network graph (top 25 edges)
    â””â”€â”€ validation_report.txt            # Statistics & metrics
```

---

## ğŸ’¡ Key Features

| Aspect | Details |
|--------|---------|
| **Training** | 8 epochs on UCI Air Quality (9,448 samples, 13 features) |
| **Stability** | Loss scaling + NaN detection + gradient clipping |
| **Output** | Learned adjacency with 132/169 non-zero edges (78%) |
| **Gradient** | Max norm ~0.03 (very stable) |
| **Visualizations** | Heatmap, distribution, network graph, report |
| **Speed** | ~2-3 min per epoch on CPU |

---

## ğŸ” Understanding the Output

### **Adjacency Matrix (A_mean.npy)**
- Shape: (13, 13) â€” one edge per feature pair
- Values: [0, 0.0825] â€” continuous edge strengths
- Interpretation: Higher values = stronger causal influence

### **Hub Structure**
From visualization, you'll see:
- **Source nodes (F1-F7):** High out-degree (many outgoing edges)
- **Target nodes (F8-F9):** High in-degree (many incoming edges)
- **Interpretation:** Environmental sensors (F1-7) influence aggregates (F8-9)

### **Statistics**
- **Sparsity:** 21.9% zeros (79% connections)
- **Distribution:** Heavy-tail (few very strong edges)
- **Top edges:** All ~0.082 (uniform top tier)

---

## ğŸ“‹ Full Documentation

See `VISUALIZATION_GUIDE.md` for:
- Detailed command options
- Troubleshooting
- Advanced usage
- Metrics explanation

---

## âœ¨ Summary

**Before:**
- Train only: `python scripts/train_rcgnn.py ...`
- Visualize separately: Manual steps

**Now:**
- One command: `python scripts/train_and_visualize.py ...`
- All visualizations generated automatically
- Complete report with all metrics

**Next time:**
- Just visualization: `python scripts/validate_and_visualize.py`
- Different thresholds: Use `--threshold` flag
- Custom export: Use `--export-dir` flag

---

**Ready to train and visualize! ğŸš€**
